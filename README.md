Программа-генератор сводной таблицы из анализов бухгалтерских счетов из 1С

Эта программа предназначена для экономистов, аналитиков, бухгалтеров и других специалистов, которые занимаются составлением сводной финансовой и управленческой отчетности по группе компаний. Например, она может быть использована для подготовки сводного отчета о движении денежных средств или отчета по инвестиционным или капитализированным расходам.
Программа позволяет объединить анализы счетов из 1С в одну сводную плоскую таблицу, что значительно упрощает дальнейший анализ и подготовку сводных отчетов.

Создание нового файла Excel

После запуска программы в папке с исходными файлами для обработки создается новый файл Excel с двумя листами: сводная таблица и таблица с отклонениями по оборотам до и после обработки. Второй лист служит для проверки правильности интеграции необходимых строк из анализов счетов в итоговый файл.

Тестирование на различных версиях 1С

Программа была протестирована на анализах счетов из 1С: Бухгалтерия 8.3 и 1С УПП. Она поддерживает анализы счетов с детализацией по субсчетам и субконто любого уровня вложенности, а также с расшифровкой любых корреспондирующих счетов по субсчетам и субконто первого уровня (не глубже).
Например, для составления сводного отчета по инвестициям можно выгрузить анализ 08 счета по каждой компании с детализацией по строящимся объектам и статьям затрат. Корреспондирующие счета могут быть расшифрованы по субсчетам, а счета 60 и 76 — по контрагентам.

Рекомендации по работе с программой

При работе с программой рекомендуется включать в название файлов идентификатор компании, так как в результирующем файле будет столбец с названием файла, по которому можно идентифицировать каждую компанию в группе.

Уровни иерархии

Важно отметить, что выгруженные в файлы Excel анализы счетов должны содержать уровни иерархии (группировки строк, которые скрываются/отображаются с помощью кнопок + и – слева в полях). По этим уровням программа будет разворачивать вложенные данные в плоский вид таблицы. Поэтому анализы счетов следует выгружать через меню "Сохранить как" в 1С.

Запуск программы

Перед запуском программы убедитесь, что нет открытых файлов Excel.

Ошибки и улучшения

Обратите внимание, что алгоритм скрипта не может учесть все особенности различных вариаций выгрузок анализов счетов из 1С, что может привести к ошибкам в работе программы. Если вы столкнулись с какими-либо ошибками или хотите предложить улучшения, пожалуйста, отправьте информацию об ошибках (вместе с образцами выгрузок анализов из 1С, которые не были корректно обработаны программой) или предложения по улучшению по контакту в телеграм @kaetosh.

Создание .exe файла с помощью pyinstaller

используйте команду:
pyinstaller --onefile --collect-all pyfiglet --icon=icon.ico main.py